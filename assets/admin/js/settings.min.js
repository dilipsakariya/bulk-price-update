!function(e,t,a){e(function(){function a(){jQuery("#bpu_save_settings").css({opacity:.5}),jQuery("#bpu_save_settings").attr("disable",!0),jQuery("#bpu_update_product_results_body").html(""),jQuery("#bpu_loader").show()}e("#ps_plugin_template_settings_tabs_header a").on("click",function(t){t.preventDefault(),!e(this).hasClass("bpu-tab-active")&&(e(this).addClass("bpu-tab-active").siblings("a").removeClass("bpu-tab-active"),e(e(this).attr("href")).addClass("bpu-tab-active").siblings(".bpu-tab-content").removeClass("bpu-tab-active"))}),e(".bpu-multi-select").multiselect({enableClickableOptGroups:!0,enableCollapsibleOptGroups:!0,enableFiltering:!0,includeSelectAllOption:!0}),jQuery("#bpu_method_"+jQuery('input[name="bpu[bpu_price_change_method]"]').val()).show(),jQuery('input[name="bpu[bpu_price_change_method]"]').change(function(e){jQuery(".bpu_method_aria_tc").hide(),jQuery("#bpu_method_"+jQuery(this).val()).show()}),jQuery("select.bpu-multi-select-product").select2({ajax:{url:ajaxurl,dataType:"json",delay:250,data:function(e){return{s:e.term,action:"bpu_get_products",page:e.page||1}},processResults:function(e,t){return t.page=t.page||1,{results:e.results,pagination:{more:50*t.page<e.count_filtered}}},cache:!0},placeholder:"Select Products...",width:"90%",minimumInputLength:0,templateResult:function e(t){return t.loading?t.text:jQuery("<div class='select2-result-repository clearfix'><div class='select2-result-repository__meta'><div class='select2-result-repository__title'>"+t.text+"</div></div></div>")},templateSelection:function e(t){return t.name||t.text}}),jQuery(".bpu_sale_price_dates_fields").find("input").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,onSelect:function(){var e=jQuery(this).is("#bpu_sale_price_dates_from")?"minDate":"maxDate",t=jQuery(this).closest(".bpu_sale_price_dates_fields").find("input"),a=jQuery(this).datepicker("getDate");t.not(this).datepicker("option",e,a),jQuery(this).trigger("change")}}),jQuery("#bpu_percentage").keypress(function(e){if(46===e.keyCode&&2===this.value.split(".").length)return!1}),e(".bpu-subscription-callout-wrapper").length>0&&(t.setTimeout(function(){e(".bpu-subscription-callout-wrapper").addClass("open")},5e3),e(".bpu-subscription-form").on("submit",function(t){t.preventDefault(),!e(".bpu-subscription-callout").hasClass("bpu-ajaxing")&&(e(".bpu-subscription-callout").addClass("bpu-ajaxing"),e.ajax({url:ajaxurl,type:"POST",dataType:"JSON",data:{action:"bpu_handle_subscription_request",email:e(".bpu-subscription-form input").val(),security:e('.bpu-subscription-form input[name="_wpnonce"]').val(),from_callout:1},success:function(t){e(".bpu-subscription-callout-thanks").show().delay(2e3).fadeOut()}}).fail(function(){e(".bpu-subscription-error").show()}).always(function(){e(".bpu-subscription-callout").removeClass("bpu-ajaxing")}))}),e(".bpu-subscription-skip").on("click",function(t){t.preventDefault(),e(".bpu-subscription-callout-wrapper").removeClass("open"),e.ajax({url:ajaxurl,type:"POST",dataType:"JSON",data:{action:"bpu_subscription_popup_shown"}})}));var p={action:"bpu_change_price_percentge"},u={action:"bpu_change_price_product_ids"},s=[],i="",n="",c="",r="",o="",l="",b="";jQuery(document).on("submit","#bpu_setting_form",function(e){if(e.preventDefault(),Array.prototype.chunk=function(e){return this.length?[this.slice(0,e)].concat(this.slice(e).chunk(e)):[]},jQuery(".bpu-progress").attr("value",0),0==s.length){if((c=jQuery("#bpu_percentage").val())>0){i=jQuery("input[name='bpu[bpu_price_change_type]']:checked").val();var t=jQuery("input[name='bpu_product_ids_nonce']").val();l=jQuery("input[name='bpu[bpu_sale_price_dates_from]']").val(),b=jQuery("input[name='bpu[bpu_sale_price_dates_to]']").val(),n=jQuery("input[name='bpu[bpu_price_type_by_change]']:checked").val(),o=jQuery("#bpu_price_rounds_point").is(":checked")?"true":"false",r=jQuery("#bpu_dry_run").is(":checked")?"true":"false","by_categories"==jQuery("input[name='bpu[bpu_price_change_method]']:checked").val()?""!=jQuery("#bpu_categories").val()?(a(),u.cat_ids=jQuery("#bpu_categories").val(),u.nonce=t,jQuery.post(ajaxurl,u,function(e){s=(s=JSON.parse(e)).chunk(5),d(),jQuery(".bpu-progress").attr("max",s.length)})):alert("Please select a Category...!!"):""!=jQuery("#bpu_products").val()?(s=(s=jQuery("#bpu_products").val()).chunk(5),a(),d(),jQuery(".bpu-progress").attr("max",s.length)):alert("Please select a Product...!!")}else alert("Please provide a Amount more-than Zero...!!")}});var d=function(e){var t=e||0;if(t<s.length){var a=jQuery("input[name='bpu_product_update_nonce']").val();p.product_id=s[t],p.opration_type=i,p.price_type_by_change=n,p.percentage=c,p.price_rounds_point=o,p.bpu_dry_run=r,p.bpu_req_count=t,p.nonce=a,p.bpu_sale_price_dates_from=l,p.bpu_sale_price_dates_to=b,jQuery.post(ajaxurl,p,function(e){jQuery("#bpu_update_product_results").show(),d(t+1),jQuery(".bpu-progress").attr("value",t+1),jQuery("#bpu_update_product_results_body").append(e)})}else s=[],jQuery("#bpu_loader").hide(),"true"==r?alert("Dry Run Complete...!!"):(jQuery("#bpu_products").val(""),jQuery("#bpu_percentage").val(""),jQuery("#bpu_sale_price_dates_from").val(""),jQuery("#bpu_sale_price_dates_to").val(""),jQuery("#bpu-multi-select").multiselect("refresh"),jQuery(".bpu-multi-select-product").length>0&&jQuery(".search-choice-close").trigger("click"),alert("Operation Complete...!!")),jQuery("#bpu_save_settings").css({opacity:""}),jQuery("#bpu_save_settings").removeAttr("disable")}})}(jQuery,window);